% easychair.tex,v 3.5 2017/03/15

\documentclass{easychair}
%\documentclass[EPiC]{easychair}
%\documentclass[EPiCempty]{easychair}
%\documentclass[debug]{easychair}
%\documentclass[verbose]{easychair}
%\documentclass[notimes]{easychair}
%\documentclass[withtimes]{easychair}
%\documentclass[a4paper]{easychair}
%\documentclass[letterpaper]{easychair}

\usepackage{doc}

\usepackage[firstpageonly=false, color={[gray]{0.5}},
   scale=2.0, text=DRAFT]{draftwatermark}
% -------------------------------
%%%% For Alectryon

\usepackage{texments}
%%% for movies by alectryon
\usepackage{../movies/snippets/assets/alectryon}
\usepackage{../movies/snippets/assets/pygments}
%%% One hypothesis per line 
\makeatletter
\renewcommand{\alectryon@hyps@sep}{\alectryon@nl}
\makeatother

%%% \snippets{A,B,C,…} inputs a series of snippets as one block (with \itemsep
%%% between them).  A, B, C should be paths to files in movies/snippets/.
\usepackage{etoolbox}
\makeatletter
\newcommand{\inputsnippets}[1]
  {{\setlength{\itemsep}{1pt}\setlength{\parsep}{0pt}% Adjust spacing
    \alectryon@copymacros\begin{io}
      \forcsvlist{\item\@inputsnippet}{#1}
    \end{io}}}
\let\input@old\input % Save definition of \input
\newcommand{\@inputsnippet}[1]
  {{\renewenvironment{alectryon}{}{}% Skip \begin{alectryon} included in snippet
    \input@old{../movies/snippets/#1}}}
\makeatother

%---------------------------- 
\newcommand{\canonseq}[2]{\mbox{$\{#1\}(#2)$}}
\newtheorem{todo}{To do}
\usepackage{amsfonts, afterpage}

\newcommand{\easychair}{\textsf{easychair}}
\newcommand{\miktex}{MiK{\TeX}}
\newcommand{\texniccenter}{{\TeX}nicCenter}
\newcommand{\makefile}{\texttt{Makefile}}
\newcommand{\latexeditor}{LEd}


%\makeindex

%% Front Matter
%%
% Regular title as in the article class.
%
\title{Hydras and Cie (Draft) \\
  Variations on Kirby \& Paris' hydra battles and ordinal numbers in Coq}



\author{
Pierre Castéran \inst{1}
\and
    Jérémy Damour \inst{2}
\and
Karl Palmskog \inst{2}
\and Clément Pit-Claudel \inst{2}
\and Théo Zimmermann %\inst{5}
}


\institute{
 LaBRI, Université Bordeaux \\
  \email{pierre.casteran@labri.fr}
\and
   Ask for agreement !
 }



\authorrunning{Castéran, Damour, Palmskog, Pit-Claudel and Zimmermann}

\titlerunning{Hydras and Cie}

\begin{document}

\maketitle


\begin{abstract}
  \begin{todo}
 \dots
  \end{todo}
\end{abstract}


% \setcounter{tocdepth}{2}
% {\small
% \tableofcontents}


%------------------------------------------------------------------------------
\section{Introduction}
\label{sect:introduction}
Hydra games (a.k.a. \emph{Hydra battles}) appear in an article published in 1982 by two mathematicians:
L. Kirby and J. Paris~\cite{KP82}: \emph{Accessible Independence Results for Peano Arithmetic}.
This article presents a gameful interpretation of accessibility problem in the set of ordinals below $\epsilon_0$, and proves two theorems:
\begin{quote}
\begin{itemize}
\item In the Hydra game, every strategy is a winning strategy for Hercules.
  \item The theorem above cannot be proved in Peano Arithmettic.
\end{itemize}
\end{quote}

Like Goodstein sequences, hydra battles may be considered as a simplified version of G\"{o}del-like theorems.
Although the mathematical contents of this 
paper are quite advanced, the rules of hydra battles are very easy to understand. There are now several sites on the Internet where you can find tutorials on hydra games, together with simulators you can play with. See, for instance, the blogpost and source code written by Andrej Bauer~\cite{bauer2008,BauerHydra}.

Our project is to illustrate  this work by a library written in \emph{Coq}~\cite{HydraBattles} and an electronic book~\cite{HydraBook}  containing explanations of the mathematical content and its possible mechanized formalisations.
This project has already been presented in
JFLA2018~\cite{JFLA2018paper}. We present the recent evolution of the library: new results, interaction within the Coq-Community project~\cite{CoqCommunity}, and documentation generated with Alectryon~\cite{alectryonpaper, alectryongithub}. 

\begin{todo}
  Comment the multiple views of a same mathematical object:
  \begin{itemize}
  \item Ordinals notations: for $\omega$, $\omega^\omega$,
    $\epsilon_0$, $\Gamma_0$. Proofs by computation whenever possible (see Fig.~\ref{Ex42-E0}.
  \item (Axiomatic) model by Schütte. Less computations.
    application of previously proven lemmas (see Fig~\ref{fig:Ex42b}).
  \item Bridge lemmas (relative correctness of different representations).
    \item The user/reader may compare  different proofs of the same result (For instance the equality $\omega+42+\omega^2= \omega^2$).
  \end{itemize}
\end{todo}

\section{New contents}
We are interested in a usual variant of hydra-battles, where the hydra grows $n$ copies at step $n$ of the game (see the examples presented in ~\cite{KP82, BauerHydra}).
In terms of ordinals, this variant is described as a (finite) sequence $s_n\,(n\geq i)$ of ordinals strictly below $\epsilon_0$.
This sequence is parameterized by an initial index $i\in\mathbb{N}$ and an ordinal $\alpha<\epsilon_0$.

\begin{itemize}
  \item $s_i=\alpha$
\item If $s_n=0$, then the sequence is empty,
\item if $s_n=\beta+1$, then $s_{n+1}=\beta$,
\item Otherwise, $s_n$ is a \emph{limit ordinal} $\lambda$; then $s_{n+1}$ is $\canonseq{\lambda}{n+1}$, \emph{i.e.} the
    $n+1$-th element of the \emph{canonical sequence} associated with $\lambda$~\cite{KS81}.
\end{itemize} 

The length of such a sequence is $l-i$, where $l$ is the first --- and unique --- natural number such that $s_l=0$.
For a given $\alpha$, this length is a function of 
the initial index $i$.

Adapting to \emph{Coq} a few lemmas from~\cite{KS81}, we prove that the length  of the sequence associated with
$\omega^\alpha$ and initial index $i\geq 2$ is greater or equal than
$F_{\omega^\alpha}(i-1)-(i-1)$, where $F_\alpha$ is a variant of the Wainer hierarchy of rapidly growing functions, defined and studied in~\cite{KS81}.

From this minoration, we infer that the function which associates to $i$ the length of the considered sequence (for a given $\alpha$) is not primitive recursive in general (our counter-example is for $\alpha=\omega^\omega$).

It is important to notice that, for proving this last result, we decided to host and maintain within \emph{Coq-Community} the formalization of primitive recursive function, part of Russel O'Connor's work on G\"{o}del's first incompleteness theorem~\cite{OConnor05}.

Defining and studying families of rapidly growing arithmetic  functions indexed by ordinals below $\epsilon_0$ has been made possible by the plug-in \emph{coq-equations}~\cite{sozeau:hal-01671777}.


\section{The Coq-community ecosystem}


\section{Documentation with Alectryon}

We present two ~examples of the documentation generated with Alectryon~\cite{alectryonpaper}: A simple proof by computation (Fig.~\ref{fig:Ex42E0}), and a longer proof where only the main steps are displayed, interleaved with plain text.

  \begin{figure}[h]
    \centering
    \fbox{
      \begin{minipage}[h]{1.0\linewidth}
        \inputsnippets{E0/Ex42}
      \end{minipage}}
    \caption{A simple proof by computation}
    \label{fig:Ex42E0}
  \end{figure}
\label{Ex42-E0}.


%\afterpage{\clearpage}

\begin{figure}[th]
  \centering
  
  
\label{Ex42-schutte}
\fbox{\begin{minipage}[h]{1.0\linewidth}
  Let us prove again the equality $\omega+42+\omega^2= \omega^2$. Let us recall that $\omega^2$ is an abbreviation of $\phi_0(2)$,
\emph{i.e} the third  additive principal ordinal.

\inputsnippets{Schutte/Ex42a}


Our proof is very different from the computational proof of Fig\ref{fig:Ex42E0}.
By definition of additive principal ordinals, 
it suffices to prove the inequality $\omega+42< \phi_0(2)$ to  fprove our lemma.

\inputsnippets{Schutte/Ex42b}

Since the set \textit{AP} of additive principals  is closed under addition
(by Lemma \textit{AP\_plus\_closed}), it suffices to prove the inequalities $\omega<\phi_0(2)$ and $42<\phi_0(2)$.

\inputsnippets{Schutte/Ex42d, Schutte/Ex42c, Schutte/Ex42e}

\end{minipage}
}
\caption{A proof interleaved with text (from the book)}
  \label{fig:Ex42b}
\end{figure}

\section{Conclusion and perspectives}

\begin{todo}
  \begin{itemize}
  \item  Soundness (correction, maintenance) of the Alectryon generated doc.
  \item Communications between co-maintained libraries
          (Ackermann, Gaia, etc.)
  \item Work destined both to Coq-users and people interested in discrete math ?
  \end{itemize}
\end{todo}


\subsection{Perspectives}


The Gaia project~\cite{Gaia}, also maintained on \textit{Coq-community} contains a development by José Grimm~\cite{grimm:hal-00911710}. This library -- dedicated  to the implementaion in \textit{Coq (SSreflect)} of books from  Bourbaki's Elements of Mathematics --- contains a generalization of two types of ordinals (\texttt{T1} for the ordinal $\epsilon_0$ and
\texttt{T2} for $\Gamma_0$) to a larger ordinal defined by Ackermann, and relates these data structures with Bourbaki's set theory.
It is interesting to note that both libraries \textit{Gaia} and \textit{hydra-battles} contain their own (isomorphic) definitions of
\texttt{T1} and \texttt{T2}, originated in~\cite{CantorContrib}.
The types --- defined in different modules --- cannot be considered as equal. Even more, some operations like addition, multiplication, etc. have now different definitions.

It would be interesting to build a library which could be used as a gate giving access to both the combinatorial results of \textit{hydra-battles} and the set-theoretic content of \textit{Gaia}.
For instance, the associativity of multiplication of ordinals below $\epsilon_0$, already proven in \textit{Gaia} could be tranferred ``for free'' to the data structures of \textit{hydra-battles}, thanks to the isomorphism between both implementations.



%\section{Acknowledgments}
%\label{sect:acks}



\label{sect:bib}
\bibliographystyle{plain}
%\bibliographystyle{alpha}
%\bibliographystyle{unsrt}
%\bibliographystyle{abbrv}
\bibliography{../thebib}


\end{document}

